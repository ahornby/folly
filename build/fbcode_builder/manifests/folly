[manifest]
name = folly
fbsource_path = fbcode/folly
shipit_project = folly
shipit_fbcode_builder = true

[git]
repo_url = https://github.com/facebook/folly.git

[build]
builder = cmake
job_weight_mib = 1024

[dependencies]
gflags
glog
googletest
boost
libevent
libsodium
double-conversion
fmt
lz4
openssl
snappy
zstd
# no zlib in the linux case, why?
# these are usually installed on the system
# and are the easiest system deps to pull in.
# In the future we want zlib manifest to handle 
# this for us like the openssl one already does

# Windows no zlib, provide it
[dependencies.os=windows]
zlib

# xz depends on autoconf which does not build on
# Windows
[dependencies.not(os=windows)]
xz

[shipit.pathmap]
fbcode/folly/public_tld = .
fbcode/folly = folly

[shipit.strip]
^fbcode/folly/folly-config\.h$
^fbcode/folly/public_tld/build/facebook_.*

[cmake.defines]
BUILD_SHARED_LIBS=OFF
BOOST_LINK_STATIC=ON

[cmake.defines.os=freebsd]
LIBDWARF_FOUND=NO

[cmake.defines.test=on]
BUILD_TESTS=ON
BUILD_BENCHMARKS=OFF

[cmake.defines.test=off]
BUILD_TESTS=OFF
BUILD_BENCHMARKS=OFF
